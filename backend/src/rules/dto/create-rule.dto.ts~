import { IsInt, IsOptional, IsString, Matches, Min } from 'class-validator';

export class CreateRuleDto {
  @IsString()
  name: string;

  // --- фильтры для GET /get_leads ---
  @IsOptional() @IsString()
  vertical?: string;       // пример: "Суставы"

  @IsOptional() @IsString()
  country?: string;        // пример: "RO"

  @IsOptional() @IsString()
  status?: string;         // "Sale" | "New" | "Reject" | "Trash"

  @IsOptional() @IsString()
  productName?: string;    // имя оффера/продукта

  @IsOptional() @IsString()
  dateFrom?: string;       // "YYYY-MM-DD"

  @IsOptional() @IsString()
  dateTo?: string;         // "YYYY-MM-DD"

  // опционально: фильтровать по productId после получения (если нужно)
  @IsOptional() @IsString()
  offerId?: string;

  // “кап” на редиректы: если в лиде есть поле redirects — отсечём > cap
  @IsOptional() @IsInt() @Min(0)
  cap?: number;

  // --- расписание/лимиты ---
  @IsInt() @Min(1)
  dailyLimit: number;

  @IsInt() @Min(1)
  minInterval: number;

  @IsInt() @Min(1)
  maxInterval: number;

  @Matches(/^\d{2}:\d{2}$/, { message: 'sendWindowStart must be HH:MM' })
  sendWindowStart: string; // "09:00"

  @Matches(/^\d{2}:\d{2}$/, { message: 'sendWindowEnd must be HH:MM' })
  sendWindowEnd: string;   // "18:00"

  // кнопка паузы
  @IsOptional()
  isPaused?: boolean;
}
